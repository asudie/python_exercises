from bs4 import BeautifulSoup

# Step 1: Read the evilcorp.html file
with open('evilcorp.html', 'r') as file:
    content = file.read()

# Step 2: Parse the HTML with BeautifulSoup
soup = BeautifulSoup(content, 'html.parser')

# Step 3: Change the page title
soup.title.string = "Evil Corp - Stealing your money every day"

# Step 4: Parse user's name and pronoun
name_tag = soup.find('span', class_='name')
pronoun_tag = name_tag.find('span', class_='pronoun')
full_name = pronoun_tag.get_text() + name_tag.get_text().replace(pronoun_tag.get_text(), '')

# Insert a new <h1> tag with the message
new_h1 = soup.new_tag('h1')
new_h1.string = f"{full_name}, you are hacked!"
soup.body.insert(0, new_h1)  # Insert the new <h1> tag at the beginning of the body

# Step 5: Insert Trenton's script into the body
script = soup.new_tag('script')
script.string = '''
    hacked = function() {
        alert('hacked');
    }
    window.addEventListener('load', 
        function() { 
            var f = document.querySelector("form");
            f.setAttribute("onsubmit", "hacked()");
        }, 
    false);
'''
soup.body.append(script)

# Step 6: Change the link at the bottom of the page
link_tag = soup.find('a')
link_tag['href'] = "https://mrrobot.fandom.com/wiki/Fsociety"
link_tag.string = "Fsociety"

# Step 7: Write the modified HTML to a new file
with open('evilcorp_hacked.html', 'w') as file:
    file.write(str(soup))

print("evilcorp_hacked.html created successfully!")
